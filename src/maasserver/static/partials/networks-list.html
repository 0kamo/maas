<header class="page-header margin-bottom" data-maas-sticky-header>
    <div class="inner-wrapper">
        <h1 class="page-header__title eight-col">
            Networks
            <span class="page-header__title--identicator" id="bulk-actions">
                <span class="power-status--power" data-ng-show="loading">
                    <span class="loader"></span>
                    Loading...
                </span>
            </span>
        </h1>
        <!-- Drop-down box -->
        <div class="page-header__actions" data-ng-show="actionOptions.length">
            <div class="page-header__cta">
                 <div class="right cta-group">
                    <div data-maas-cta="actionOptions"
                         data-default-title="Add"
                         data-ng-model="actionOption"
                         data-ng-change="actionChanged()">
                    </div>
                </div>
            </div>
        </div>
        <div class="page-header__dropdown border u-padding--top margin-bottom" data-ng-if="actionOption.name == 'add_fabric'">
            <maas-obj-form obj="newObject" manager="fabricManager" manager-method="createItem"
                inline="true" save-on-blur="false" after-save="cancelAction()">
                <div class="left">
                    <maas-obj-field
                        type="text" key="name" label="Add fabric" subtle="false"
                        placeholder="Name (optional)"></maas-obj-field>
                    <maas-obj-errors></maas-obj-errors>
                </div>
                <div class="right">
                    <a class="link-cta-ubuntu text-button" data-ng-click="cancelAction()">Cancel</a>
                    <button class="cta-ubuntu" maas-obj-save>Add fabric</button>
                </div>
            </maas-obj-form>
        </div>
        <div class="page-header__dropdown border u-padding--top margin-bottom" data-ng-if="actionOption.name == 'add_vlan'">
            <maas-obj-form obj="newObject" manager="vlanManager" manager-method="createItem"
                inline="true" save-on-blur="false" after-save="cancelAction()">
                <div class="left">
                    <maas-obj-field class="u-margin--right"
                        type="text" key="name" label="Add VLAN" subtle="false"
                        placeholder="Name (optional)"></maas-obj-field>
                    <maas-obj-field class="u-margin--right"
                        type="text" key="vid" label="with VID" subtle="false"
                        placeholder="numeric value 1-4094"></maas-obj-field>
                    <maas-obj-field
                        type="options" key="fabric" label="to fabric" subtle="false"
                        options="f.id as f.name for f in fabrics"
                        placeholder="Select fabric"></maas-obj-field>
                    <maas-obj-errors></maas-obj-errors>
                </div>
                <div class="right">
                    <a class="link-cta-ubuntu text-button" data-ng-click="cancelAction()">Cancel</a>
                    <button class="cta-ubuntu" maas-obj-save>Add VLAN</button>
                </div>
            </maas-obj-form>
        </div>
        <div class="page-header__dropdown border u-padding--top margin-bottom" data-ng-if="actionOption.name == 'add_space'">
            <maas-obj-form obj="newObject" manager="spaceManager" manager-method="createItem"
                inline="true" save-on-blur="false" after-save="cancelAction()">
                <div class="left">
                    <maas-obj-field
                        type="text" key="name" label="Add space" subtle="false"
                        placeholder="Name (optional)"></maas-obj-field>
                    <maas-obj-errors></maas-obj-errors>
                </div>
                <div class="right">
                    <a class="link-cta-ubuntu text-button" data-ng-click="cancelAction()">Cancel</a>
                    <button class="cta-ubuntu" maas-obj-save>Add space</button>
                </div>
            </maas-obj-form>
        </div>
        <div class="page-header__dropdown border" data-ng-if="actionOption.name == 'add_subnet'">
            <h3 class="u-padding--top">Add subnet</h3>
            <maas-obj-form obj="newObject" manager="subnetManager" manager-method="createItem"
                table-form="true" save-on-blur="false" pre-process="actionSubnetPreSave" after-save="cancelAction()">
                <div class="twelve-col">
                    <maas-obj-field class="inline six-col"
                        type="text" key="name" label="Name" placeholder="Name (optional)"
                        label-width="two" input-width="three"></maas-obj-field>
                    <maas-obj-field class="inline six-col last-col"
                        type="text" key="dns_servers" label="DNS servers"
                        placeholder="Use IPv4 or IPv6 format (optional)"
                        label-width="two" input-width="three"></maas-obj-field>
                    <maas-obj-field class="inline six-col"
                        type="text" key="cidr" label="CIDR"
                        placeholder="Use IPv4 or IPv6 format"
                        label-width="two" input-width="three"></maas-obj-field>
                    <maas-obj-field class="inline six-col last-col"
                        type="options" key="vlan" label="Farbic &amp; VLAN" placeholder="Choose Fabric &amp; VLAN"
                        options="v.id as getVLANName(v) group by getFabricNameById(v.fabric) for v in vlans"
                        label-width="two" input-width="three"></maas-obj-field>
                    <maas-obj-field class="inline six-col"
                        type="text" key="gateway_ip" label="Gateway IP"
                        placeholder="Use IPv4 or IPv6 format (optional)"
                        label-width="two" input-width="three"></maas-obj-field>
                    <maas-obj-field class="inline six-col last-col"
                        type="options" key="space" label="Space" placeholder="Choose Space"
                        options="space.id as space.name for space in spaces"
                        label-width="two" input-width="three"></maas-obj-field>
                </div>
                <div class="page-header__feedback twelve-col no-margin-bottom">
                    <div class="left">
                        <maas-obj-errors></maas-obj-errors>
                    </div>
                    <div class="right">
                        <a class="link-cta-ubuntu text-button" data-ng-click="cancelAction()">Cancel</a>
                        <button class="cta-ubuntu" maas-obj-save>Add subnet</button>
                    </div>
                </div>
            </maas-obj-form>
        </div>
    </div>
</header>
<section class="row no-padding-top">
    <div class="inner-wrapper">
        <div class="twelve-col">
            <form class="form form--inline four-col">
                <div class="form__group listing-filter">
                    <label class="u-margin--right-small" for="network-filter">Group by</label>
                    <select name="network-filter" class="listing-filter__select" id="networks-groupby" data-ng-model="groupBy" data-ng-change="updateGroupBy()">
                        <option value="fabric" selected="selected">Fabrics</option>
                        <option value="space">Spaces</option>
                    </select>
                    <span class="icon help tooltip tooltip--right"
                          data-tooltip="Fabric is a set of consistent interconnected VLANs that are capable of mutual communication.&#xa;Space is a grouping of subnets that are able to mutually communicate with each other.&#xa;Subnets within a space do not need to belong to the same fabric."></span>
                </div>
            </form>
            <!-- XXX mpontillo temporarily hidden -->
            <div class="eight-col last-col ng-hide">
                <div class="search">
                  <input placeholder="Search" class="search__input" type="search">
                  <input class="search__submit" type="submit">
              </div>
            </div>
        </div>
        <div class="twelve-col ng-hide" data-ng-show="!loading">
            <!-- Spaces grouped table -->
            <table class="table-listing ng-hide" data-ng-show="groupBy === 'space'">
                <thead>
                    <tr class="table-listing__row">
                        <th class="table__column--3 ng-hide">
                            <input class="checkbox" type="checkbox" id="spaces-all" />
                            <label class="checkbox-label" for="spaces-all"></label>
                        </th>
                        <th class="table__column--20">Space</th>
                        <th class="table__column--30">Subnet</th>
                        <th class="table__column--13 align-right">Available IPs</th>
                        <th class="table__column--20">VLAN</th>
                        <th class="table__column--20">Fabric</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="table-listing__row" data-ng-repeat="row in group.spaces.rows">
                        <td class="table-listing__cell table__column--3 ng-hide">
                            <div data-ng-if="row.space_name">
                                <input class="checkbox" type="checkbox" id="space-{$ row.space.id $}" />
                                <label class="checkbox-label" for="space-{$ row.space.id $}"></label>
                            </div>
                        </td>
                        <td class="table-listing__cell table__column--20">
                            <a href="#/space/{$ row.space.id $}">{$ row.space_name $}</a>
                        </td>
                        <td class="table-listing__cell table__column--30">
                            <a href="#/subnet/{$ row.subnet.id $}">{$ row.subnet_name $}</a>
                        </td>
                        <td class="table-listing__cell table__column--13 align-right">
                            {$ row.subnet.statistics.available_string $}
                        </td>
                        <td class="table-listing__cell table__column--20">
                            <a href="#/vlan/{$ row.vlan.id $}">{$ row.vlan_name $}</a>
                        </td>
                        <td class="table-listing__cell table__column--20">
                            <a href="#/fabric/{$ row.fabric.id $}">{$ row.fabric.name $}</a>
                        </td>
                    </tr>
                </tbody>
            </table>
            <!-- Fabric grouped table -->
            <table class="table-listing ng-hide" data-ng-show="groupBy === 'fabric'">
                <thead>
                    <tr class="table-listing__row">
                        <th class="table__column--3 ng-hide">
                            <input class="checkbox" type="checkbox" id="fabrics-all" />
                            <label class="checkbox-label" for="fabrics-all"></label>
                        </th>
                        <th class="table__column--15">Fabric</th>
                        <th class="table__column--15">VLAN</th>
                        <th class="table__column--27">Subnet</th>
                        <th class="table__column--15 align-right">Available IPs</th>
                        <th class="table__column--25">Space</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="table-listing__row" data-ng-repeat="row in group.fabrics.rows">
                        <td class="table-listing__cell table__column--3 ng-hide">
                            <div data-ng-if="row.fabric_name">
                                <input class="checkbox" type="checkbox" id="fabric-{$ row.fabric.id $}" />
                                <label class="checkbox-label" for="fabric-{$ row.fabric.id $}"></label>
                            </div>
                        </td>
                        <td class="table-listing__cell table__column--15">
                            <a href="#/fabric/{$ row.fabric.id $}">{$ row.fabric_name $}</a>
                        </td>
                        <td class="table-listing__cell table__column--15">
                            <a href="#/vlan/{$ row.vlan.id $}">{$ row.vlan_name $}</a>
                        </td>
                        <td class="table-listing__cell table__column--27">
                            <a href="#/subnet/{$ row.subnet.id $}">{$ row.subnet_name $}</a>
                        </td>
                        <td class="table-listing__cell table__column--15 align-right">
                            {$ row.subnet.statistics.available_string $}
                        </td>
                        <td class="table-listing__cell table__column--25">
                            <a href="#/space/{$ row.space.id $}">{$ row.space.name $}</a>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</section>
