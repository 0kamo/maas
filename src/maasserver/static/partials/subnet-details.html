<div data-ng-if="loaded">
    <header class="page-header margin-bottom" data-maas-sticky-header>
        <div class="inner-wrapper">
            <h1 class="page-header__title twelvel-col">
                {$ subnet.cidr $}
                <span class="page-header__title--identicator">
                    <span class="power-status" data-ng-if="subnet.name && subnet.cidr != subnet.name">
                        {$ subnet.name $}
                    </span>
                </span>
            </h1>
        </div>
    </header>
    <section class="row">
        <div class="inner-wrapper">
           <dl class="six-col">
                <div data-ng-if="subnet.dns_servers.length">
                    <dt class="two-col">
                        DNS <ng-pluralize count="subnet.dns_servers.length"
                          when="{'one': 'Server', 'other': 'Servers'}"></ng-pluralize>
                    </dt>
                    <dd class="four-col last-col" >
                        <span data-ng-repeat="server in subnet.dns_servers">
                            {$ server $}{$ $last ? '' : ', ' $}
                        </span>
                    </dd>
                </div>
                <dt class="two-col">Default Gateway</dt>
                <dd class="four-col last-col">{$ subnet.gateway_ip $}</dd>
                <!-- XXX mpontillo 2015-09-29
                    Missing: Fabric name, VID (optional name), clusters (with links)
                --->
            </dl>
            <dl class="six-col last-col">
                <!--
                XXX mpontillo 2015-09-29
                Missing: description, management, allocation ranges
                TBD: Move to new format.
                -->
                <dt class="two-col">Utilisation</dt>
                <dd class="four-col last-col">{$ subnet.statistics.usage_string $} used ({$ subnet.statistics.num_unavailable $}/{$ subnet.statistics.total_addresses $})</dd>
                <dt class="two-col">Largest available range</dt>
                <dd class="four-col last-col">
                    {$ subnet.statistics.largest_available $}
                    <ng-pluralize count="subnet.statistics.largest_available"
                                  when="{'one': 'address', 'other': 'addresses'}"></ng-pluralize>
                </dd>
            </dl>
            <div class="twelve-col">
                <h1>IP Ranges</h1>
                <div class="table">
                    <header class="table__head">
                        <div class="table__row">
                            <!-- XXX mpontillo IPv6 addresses may overflow the column width. -->
                            <div class="table__header table__column--25">Start IP Address</div>
                            <div class="table__header table__column--25">End IP Address</div>
                            <!-- XXX mpontillo these fields are in the design, but we do not yet have the data.
                            <div class="table__header table__column--10">Amount</div>
                            <div class="table__header table__column--10">Used</div>
                            -->
                            <div class="table__header table__column--25">Purpose</div>
                            <div class="table__header table__column--25">Owner</div>
                            <!-- XXX mpontillo this field is in the design, but only "half way" - is it needed?
                            <div class="table__header table__column--20">Date created</div>
                            -->
                        </div>
                    </header>
                    <section class="table__body">
                        <div class="table__row" data-ng-repeat="iprange in relatedIPRanges">
                            <div class="table__data table__column--25">{$ iprange.start_ip $}</div>
                            <div class="table__data table__column--25">{$ iprange.end_ip $}</div>
                            <div class="table__data table__column--25">{$ iprange.type $}</div>
                            <div class="table__data table__column--25">{$ iprange.user $}</div>
                        </div>
                    </section>
                </div>
            </div>
            <div class="twelve-col">
                <h1>IP Addresses Used</h1>
                <div class="table">
                    <header class="table__head">
                        <div class="table__row">
                            <div class="table__header table__column--15">IP Address</div>
                            <div class="table__header table__column--15">Owner</div>
                            <div class="table__header table__column--20">Usage</div>
                            <div class="table__header table__column--15">Usage type</div>
                            <div class="table__header table__column--15">Allocation type</div>
                            <div class="table__header table__column--20">Fully Qualified Name</div>
                        </div>
                    </header>
                    <section class="table__body">
                        <div class="table__row" data-ng-repeat="ip in subnet.ip_addresses">
                            <div class="table__data table__column--15">{$ ip.ip $}</div>
                            <div class="table__data table__column--15">{$ ip.user $}</div>
                            <div class="table__data table__column--20">
			      <!--
                              XXX ltrager 2015-12-02
                              node_type is an enum of node(0), device(1), or rack_controller(2). We need to create some type of Javascript enum to represent this
                              -->
                                <a href="#/node/{$ ip.node_summary.system_id $}" data-ng-if="ip.node_summary.node_type == 0">{$ ip.node_summary.hostname $}</a>
                                <span data-ng-if="ip.node_summary.node_type == 1">{$ ip.node_summary.hostname $}</span>
			    </div>
                            <div class="table__data table__column--15">{$ ip.node_summary.node_type == 0 ? "Node" : "Device" $}</div>
                            <div class="table__data table__column--15" data-ng-switch="ip.alloc_type">
                                <span data-ng-switch-when="0">Automatic</span>
                                <span data-ng-switch-when="1">Sticky</span>
                                <span data-ng-switch-when="4">User reserved</span>
                                <span data-ng-switch-when="5">DHCP</span>
                                <span data-ng-switch-when="6">Observed</span>
                                <span data-ng-switch-default>Unknown</span>
                            </div>
                            <div class="table__data table__column--20">
                                <a href="#/node/{$ ip.node_summary.system_id $}" data-ng-if="ip.node_summary.node_type == 0">{$ ip.node_summary.fqdn $}.</a>
                                <span data-ng-if="ip.node_summary.node_type != 0">{$ ip.node_summary.fqdn $}.</span>
                            </div>
                        </div>
                    </section>
                </div>
            </div>
        </div>
    </section>
</div>
