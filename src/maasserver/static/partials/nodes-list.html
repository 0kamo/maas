<header class="page-header margin-bottom" data-maas-sticky-header>
    <div class="inner-wrapper">
        <h1 class="page-header__title eight-col">{$ $parent.site $} MAAS
            <span class="page-header__title--identicator" id="bulk-actions">
                <!-- XXX blake_r 2015-02-19 - Need to add e2e test. -->
                <a href=""
                    data-ng-class="{ active: currentpage === 'nodes' }"
                    data-ng-click="toggleTab('nodes')">{$ nodes.length $} <ng-pluralize count="nodes.length" when="{'one': 'Node', 'other': 'Nodes'}"></ng-pluralize></a>
                <span class="divide"></span>
                <a href=""
                    data-ng-class="{ active: currentpage === 'devices' }"
                    data-ng-click="toggleTab('devices')">{$ devices.length $} <ng-pluralize count="devices.length" when="{'one': 'Device', 'other': 'Devices'}"></ng-pluralize>
                </a>
                <span class="power-status--power" data-ng-show="loading">
                    <span class="loader"></span>
                    Loading...
                </span>
            </span>
        </h1>
        <!-- XXX blake_r 2015-02-19 - Need to add e2e test. -->
        <div data-ng-show="currentpage === 'nodes'">
            <div class="page-header__actions">
                <div class="page-header__cta" data-ng-hide="tabs.nodes.selectedItems.length">
                    <div class="right" data-maas-cta="addHardwareOptions"
                        data-ng-model="addHardwareOption"
                        data-ng-change="addHardwareOptionChanged()" data-default-title="Add Hardware">
                    </div>
                </div>
                <div class="page-header__cta ng-hide" data-ng-show="tabs.nodes.selectedItems.length">
                    <span class="page-header__cta-feedback" data-ng-click="showSelected('nodes')">
                        {$ tabs.nodes.selectedItems.length $} Selected
                    </span>
                    <div data-maas-cta="tabs.nodes.takeActionOptions"
                        data-ng-model="tabs.nodes.actionOption"
                        data-ng-change="actionOptionSelected('nodes')">
                    </div>
                </div>
            </div>
            <!-- XXX blake_r 2015-02-19 - Need to add e2e test. -->
            <div class="page-header__dropdown ng-hide" data-ng-show="tabs.nodes.actionOption">
                <!-- XXX blake_r 2015-02-19 - Need to add e2e test. -->
                <div class="page-header__feedback ng-hide" data-ng-hide="isActionError('nodes') || hasActionsInProgress('nodes')">
                    <form class="form-inline">
                        <span class="ng-hide" data-ng-show="tabs.nodes.actionOption.name === 'deploy'">
                            <label for="image">Choose your image</label>
                            <span data-maas-os-select="osinfo" data-ng-model="tabs.nodes.osSelection"></span>
                        </span>
                        <!-- XXX rbanffy 2015-03-23 - Need to add e2e test. -->
                        <span class="ng-hide" data-ng-show="tabs.nodes.actionOption.name === 'set-zone'">
                            <span class="five-col no-margin-bottom">
                              <span class="inline">
                                <label for="zone">Select Zone</label>
                                <select name="zone" id="zone" class="three-col" placeholder="Choose a zone"
                                    data-ng-model="tabs.nodes.zoneSelection"
                                    data-ng-options="zone as zone.name for zone in zones">
                                    <option value="" disabled="disabled">Choose a zone</option>
                                </select>
                              </span>
                            </span>
                        </span>
                        <div class="right">
                            <a href="" class="margin-right" data-ng-click="actionCancel('nodes')">Cancel</a>
                            <button class="cta-ubuntu" data-ng-click="actionGo('nodes')" data-ng-hide="hasActionsFailed('nodes')">Go</button>
                            <button class="cta-ubuntu" data-ng-click="actionGo('nodes')" data-ng-show="hasActionsFailed('nodes')">Retry</button>
                        </div>
                    </form>
                </div>

                <!-- XXX blake_r 2015-02-19 - Need to add e2e test. -->
                <div class="page-header__feedback ng-hide" data-ng-show="isActionError('nodes')">
                    <!-- XXX blake_r 2015-02-19 - Need to add e2e test. -->
                    <p class="page-header__feedback-message info" data-ng-hide="isDeployError('nodes') || isSSHKeyError('nodes')">
                        {$ tabs.nodes.actionErrorCount $}
                        <span data-ng-pluralize count="tabs.nodes.selectedItems.length" when="{'one': 'node', 'other': 'nodes'}"></span>
                        cannot be {$ tabs.nodes.actionOption.sentence $}. To proceed, update your selection.
                    </p>
                    <!-- XXX blake_r 2015-02-19 - Need to add e2e test. -->
                    <p class="page-header__feedback-message info ng-hide" data-ng-show="isDeployError('nodes')">
                        {$ tabs.nodes.selectedItems.length $}
                        <span data-ng-pluralize count="tabs.nodes.selectedItems.length" when="{'one': 'node', 'other': 'nodes'}"></span>
                        cannot be {$ tabs.nodes.actionOption.sentence $}, because the required boot images have not been imported. To import boot images, visit the <a href="images/">images page</a>.
                    </p>
                    <p class="page-header__feedback-message info ng-hide" data-ng-show="isSSHKeyError('nodes')">
                        {$ tabs.nodes.selectedItems.length $}
                        <span data-ng-pluralize count="tabs.nodes.selectedItems.length" when="{'one': 'node', 'other': 'nodes'}"></span>
                        cannot be {$ tabs.nodes.actionOption.sentence $}, because an SSH key has not been added to your account. To add an SSH key, visit <a href="account/prefs/">your account page</a>.
                    </p>
                </div>

                <!-- XXX blake_r 2015-05-07 - Need to add e2e test. -->
                <div class="page-header__feedback ng-hide" data-ng-show="hasActionsInProgress('nodes') || hasActionsFailed('nodes')">
                    <p class="page-header__feedback-message progress" data-ng-show="hasActionsInProgress('nodes')">
                        <span class="loader"></span>
                        {$ tabs.nodes.actionProgress.completed $} of {$ tabs.nodes.actionProgress.total $}
                        nodes have been {$ tabs.nodes.actionOption.sentence $}.
                    </p>
                    <p class="page-header__feedback-message error"
                        data-ng-repeat="(error, nodes) in tabs.nodes.actionProgress.errors">
                        The {$ tabs.nodes.actionOption.title.toLowerCase() $} action for {$ nodes.length $}
                        <span data-ng-pluralize count="nodes.length" when="{'one': 'node', 'other': 'nodes'}"></span>
                        failed with error: {$ error $}
                    </p>
                </div>
            </div>
            <div class="page-header__dropdown border ng-hide" data-ng-show="addHardwareScope.viewable" data-ng-controller="AddHardwareController">
                <h3>Add machine</h3>
                <div class="page-header__feedback" data-ng-hide="architectures.length">
                    <!-- XXX blake_r 2015-02-24 - Need to add e2e test. -->
                    <p class="page-header__feedback-message info">
                        Cannot add {$ mode $} until boot images have been imported. To fix, visit the <a href="images">images page</a>.
                    </p>
                </div>
                <form class="twelve-col ng-hide"  data-ng-show="showMachine()">
                    <fieldset class="six-col no-padding no-margin-bottom">
                        <div class="inline">
                            <label for="cluser" class="two-col">Cluster</label>
                            <select name="cluster" id="cluster" class="three-col" placeholder="Choose a cluster"
                                data-ng-model="machine.cluster"
                                data-ng-options="cluster as cluster.cluster_name for cluster in clusters">
                            </select>
                        </div>
                        <div class="inline">
                            <label for="machine-name" class="two-col">Machine name</label>
                            <input type="text" id="machine-name" class="three-col" placeholder="Choose a machine name"
                                data-ng-model="machine.name">
                        </div>
                        <div class="inline">
                            <label for="architecture" class="two-col">Architecture</label>
                            <select name="architecture" id="architecture" class="three-col" placeholder="Choose an architecture"
                                data-ng-model="machine.architecture"
                                data-ng-options="arch for arch in architectures">
                            </select>
                        </div>
                        <div class="inline">
                            <label for="min_hwe_kernel" class="two-col">Minimum Kernel</label>
                            <select name="min_hwe_kernel" id="min_hwe_kernel" class="three-col" placeholder="No minimum kernel"
                                data-ng-model="machine.min_hwe_kernel"
                                data-ng-options="hwe_kernel for hwe_kernel in hwe_kernels">
                                <option value="">No minimum kernel</option>
                            </select>
                        </div>
                        <div class="inline">
                            <label for="zone" class="two-col">Zone</label>
                            <select name="zone" id="zone" class="three-col" placeholder="Choose a zone"
                                data-ng-model="machine.zone"
                                data-ng-options="zone as zone.name for zone in zones">
                            </select>
                        </div>
                        <div class="inline five-col" data-ng-repeat="mac in machine.macs">
                            {$ mac $}
                            <label for="mac-address" class="two-col"><span data-ng-hide="mac !== machine.macs[0]">MAC Address</span></label>
                            <input type="text" id="mac-address" class="three-col last-col" placeholder="00:00:00:00:00:00"
                                   data-ng-class="{ invalid: mac.error }"
                                   data-ng-model="mac.mac" data-ng-change="validateMac(mac)">
                            <span class="icon remove" title="Delete MAC"
                                data-ng-hide="mac === machine.macs[0]" data-ng-click="removeMac(mac)"></span>
                        </div>
                        <div class="inline five-col">
                            <a href="" class="link-cta-ubuntu secondary right" data-ng-click="addMac()">+ Add MAC Address</a>
                        </div>
                    </fieldset>
                    <fieldset class="six-col last-col no-padding no-margin-bottom"
                        data-maas-power-parameters="machine.cluster.power_types"
                        data-ng-model="machine.power">
                    </fieldset>
                </form>
                <form action="post" class="twelve-col ng-hide" data-ng-show="showChassis()">
                    <fieldset class="six-col">
                        <div class="inline">
                            <label for="cluser" class="two-col">Cluster</label>
                            <select name="cluster" id="cluster" class="three-col" placeholder="Choose a cluster"
                                data-ng-model="chassis.cluster"
                                data-ng-options="cluster as cluster.cluster_name for cluster in clusters">
                            </select>
                        </div>
                    </fieldset>
                    <fieldset class="six-col last-col"
                        data-maas-power-parameters="chassisPowerTypes"
                        data-ng-model="chassis.power">
                    </fieldset>
                </form>
                <div class="page-header__feedback twelve-col no-margin-bottom" data-ng-show="showMachine()">
                    <form class="form-inline">
                        <span class="ng-hide" data-ng-show="error">
                            <p class="page-header__feedback-message info">{$ error $}</p>
                        </span>
                        <div class="right align-right">
                            <a href="" class="margin-right alt" data-ng-click="cancel()">Cancel</a>
                            <button class="cta-ubuntu secondary margin-right--ten"
                                data-ng-class="{ disabled: machineHasError() }"
                                data-ng-click="saveMachine(true)">Save and add another</button>
                            <button class="cta-ubuntu"
                                data-ng-class="{ disabled: machineHasError() }"
                                data-ng-click="saveMachine(false)">Save machine</button>
                        </div>
                    </form>
                </div>
                <div class="page-header__feedback twelve-col no-margin-bottom ng-hide" data-ng-show="showChassis()">
                    <form class="form-inline">
                        <span class="ng-hide" data-ng-show="error">
                            <p class="page-header__feedback-message info">{$ error $}</p>
                        </span>
                        <div class="right align-right">
                            <a href="" class="margin-right alt" data-ng-click="cancel()">Cancel</a>
                            <button class="cta-ubuntu secondary margin-right--ten"
                                data-ng-class="{ disabled: chassisHasErrors() }"
                                data-ng-click="saveChassis(true)">Save and add another</button>
                            <button class="cta-ubuntu"
                                data-ng-class="{ disabled: chassisHasErrors() }"
                                data-ng-click="saveChassis(false)">Save chassis</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <!-- XXX blake_r 2015-03-31 - Need to add e2e test. -->
        <div data-ng-show="currentpage === 'devices'">
            <div class="page-header__actions">
                <div class="page-header__cta" data-ng-hide="tabs.devices.selectedItems.length">
                    <button class="cta-ubuntu"
                        data-ng-click="addDevice()"
                        data-ng-hide="addDeviceScope.viewable">Add Device</button>
                    <button class="cta-ubuntu secondary ng-hide"
                        data-ng-click="cancelAddDevice()"
                        data-ng-show="addDeviceScope.viewable">Cancel add device</button>
                </div>
                <div class="page-header__cta ng-hide four-col no-margin-bottom" data-ng-show="tabs.devices.selectedItems.length">
                    <span class="page-header__cta-feedback two-col no-margin-bottom" data-ng-click="showSelected('devices')">
                        {$ tabs.devices.selectedItems.length $} Selected
                    </span>
                    <div class="two-col no-margin-bottom last-col">
                        <div data-maas-cta="tabs.devices.takeActionOptions"
                            data-ng-model="tabs.devices.actionOption"
                            data-ng-change="actionOptionSelected('devices')">
                        </div>
                    </div>
                </div>
            </div>
            <!-- XXX blake_r 2015-04-02 - Need to add e2e test. -->
            <div class="page-header__dropdown ng-hide" data-ng-show="tabs.devices.actionOption">
                <!-- XXX blake_r 2015-04-02 - Need to add e2e test. -->
                <div class="page-header__feedback ng-hide" data-ng-hide="isActionError('devices') || hasActionsInProgress('devices')">
                     <!-- XXX blake_r 2015-04-02 - Need to add e2e test. -->
                    <form class="form-inline">
                        <span class="ng-hide" data-ng-show="tabs.devices.actionOption.name === 'set-zone'">
                            <label for="zone">Select Zone</label>
                            <select name="zone" id="zone" placeholder="Choose a zone"
                                data-ng-model="tabs.devices.zoneSelection"
                                data-ng-options="zone as zone.name for zone in zones">
                                <option value="" disabled="disabled">Choose a zone</option>
                            </select>
                        </span>
                        <div class="right">
                            <a href="" class="margin-right" data-ng-click="actionCancel('devices')">Cancel</a>
                            <button class="cta-ubuntu" data-ng-click="actionGo('devices')">Go</button>
                        </div>
                    </form>
                </div>

                <!-- XXX blake_r 2015-04-02 - Need to add e2e test. -->
                <div class="page-header__feedback ng-hide" data-ng-show="isActionError('devices')">
                    <p class="page-header__feedback-message info">
                        {$ tabs.devices.actionErrorCount $}
                        <span data-ng-pluralize count="tabs.devices.selectedItems.length" when="{'one': 'device', 'other': 'devices'}"></span>
                        cannot be {$ tabs.devices.actionOption.sentence $}. To proceed, update your selection.
                    </p>
                </div>

                <!-- XXX blake_r 2015-05-07 - Need to add e2e test. -->
                <div class="page-header__feedback ng-hide" data-ng-show="hasActionsInProgress('devices') || hasActionsFailed('devices')">
                    <p class="page-header__feedback-message" data-ng-show="hasActionsInProgress('devices')">
                        <span class="power-status--power checking">
                            <span class="loader"></span>
                            {$ tabs.devices.actionProgress.completed $} of {$ tabs.devices.actionProgress.total $}
                            devices have been {$ tabs.devices.actionOption.sentence $}.
                        </span>
                    </p>
                    <p class="page-header__feedback-message info"
                        data-ng-repeat="(error, devices) in tabs.devices.actionProgress.errors">
                        The {$ tabs.devices.actionOption.title.toLowerCase() $} action for {$ devices.length $}
                        <span data-ng-pluralize count="devices.length" when="{'one': 'device', 'other': 'devices'}"></span>
                        failed with error: {$ error $}
                    </p>
                </div>
            </div>
            <div class="page-header__dropdown ng-hide" data-ng-show="addDeviceScope.viewable" data-ng-controller="AddDeviceController">
                <h3>Add device</h3>
                <form class="twelve-col">
                    <fieldset class="twelve-col last-col no-padding">
                        <div class="inline">
                            <label for="device-name" class="two-col">Name</label>
                            <input type="text" id="device-name" class="three-col" placeholder="Name your device"
                                data-ng-model="device.name"
                                data-ng-class="{ invalid: nameHasError() }">
                        </div>
                    </fieldset>
                    <table class="margin-bottom table-listing">
                        <thead>
                            <tr class="table-listing__row">
                                <th class="t20">MAC address</th>
                                <th class="t20">IP assignment</th>
                                <th class="t20">Network</th>
                                <th class="t35">IP address</th>
                                <th class="t5"></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="table-listing__row"
                                data-ng-repeat="interface in device.interfaces">
                                <td class="t20 table-listing__cell">
                                    <input type="text" id="mac-address" placeholder="00:00:00:00:00:00"
                                        data-ng-model="interface.mac"
                                        data-ng-class="{ invalid: macHasError(interface) }">
                                </td>
                                <td class="t20 table-listing__cell">
                                    <select name="ip-assignment" id="ip-assignment"
                                        placeholder="Select IP assignment" data-ng-model="interface.ipAssignment"
                                        data-ng-options="assigment.title for assigment in ipAssignments">
                                        <option value="" disabled selected>Select IP assignment</option>
                                    </select>
                                </td>
                                <td class="t20 table-listing__cell">
                                    <select name="network" id="network"
                                        placeholder="Select network" data-ng-model="interface.clusterInterfaceId"
                                        data-ng-options="cInterface.id as cInterface.network for cInterface in getManagedInterfaces()"
                                        data-ng-show="interface.ipAssignment.name === 'static'">
                                        <option value="" disabled selected>Select network</option>
                                    </select>
                                </td>
                                <td class="t35 table-listing__cell">
                                    <input type="text" id="ip-address" placeholder="000.000.000.000"
                                        data-ng-model="interface.ipAddress"
                                        data-ng-class="{ invalid: ipHasError(interface) }"
                                        data-ng-show="interface.ipAssignment.name === 'external'">
                                    <input type="text" id="ip-address" ng-placeholder="getInterfaceStaticRange(interface.clusterInterfaceId)"
                                        data-ng-model="interface.ipAddress"
                                        data-ng-class="{ invalid: ipHasError(interface) }"
                                        data-ng-show="interface.ipAssignment.name === 'static' && interface.clusterInterfaceId">
                                </td>
                                <td class="t5 align-right">
                                    <!-- space needed to set correct height -->
                                    <span data-ng-show="isPrimaryInterface(interface)">&nbsp;</span>
                                    <a title="Delete interface" class="icon remove"
                                        data-ng-click="deleteInterface(interface)"
                                        data-ng-hide="isPrimaryInterface(interface)">delete</a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="cta-ubuntu secondary" data-ng-click="addInterface()">+ Add another interface</button>
                </form>
                <div class="page-header__feedback twelve-col no-margin-bottom">
                    <div class="twelve-col ng-hide" data-ng-show="error">
                        <p class="page-header__feedback-message info">{$ error $}</p>
                    </div>
                    <div class="right align-right">
                        <a href="" class="margin-right alt" data-ng-click="cancel()">Cancel</a>
                        <button class="cta-ubuntu secondary"
                            data-ng-class="{ disabled: deviceHasError() }"
                            data-ng-click="save(true)">Save and add another</button>
                        <button class="cta-ubuntu"
                            data-ng-class="{ disabled: deviceHasError() }"
                            data-ng-click="save(false)">Save device</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>

<div class="inner-wrapper">
    <!-- <ul id="flash-messages"  class="flash-messages hidden">
        {% for persistent_error in persistent_errors %}
        <li class="flash-messages__item warning">{{ persistent_error }}</li>
        {% endfor %}
        {% if messages %}
            {% for message in messages %}
                <li{% if message.tags %} class="flash-messages__item {{ message.tags }}" {% endif %}>{{ message }}</li>
            {% endfor %}
        {% endif %}
    </ul> -->
    <aside id="sidebar" class="sidebar" data-ng-show="currentpage === 'nodes'"
        data-ng-class="{ disabled: tabs.nodes.actionOption }">
        <div class="accordion three-col maas-accordion">
            <h3 class="accordion__title">Filter by</h3>
            <!-- XXX blake_r 2015-02-18 - Need to add e2e test. -->
            <div class="ng-hide accordion__tab" data-ng-show="tabs.nodes.metadata.status.length">
                <h4 class="accordion__tab-title maas-accordion-tab active">Status</h4>
                <div class="accordion__tab-content">
                    <ul class="accordion__tab-list">
                        <!-- XXX blake_r 2015-02-18 - Need to add e2e test. -->
                        <li class="accordion__tab-item" data-ng-repeat="status in tabs.nodes.metadata.status | orderBy:['name', '-count']" data-ng-class="{ active: isFilterActive('status', status.name, 'nodes') }">
                            <a class="accordion__tab-link" href="" data-ng-click="toggleFilter('status', status.name, 'nodes')">{$ status.name $} ({$ status.count $})</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="ng-hide accordion__tab" data-ng-show="tabs.nodes.metadata.owner.length">
                <h4 class="accordion__tab-title maas-accordion-tab">Owner</h4>
                <div class="accordion__tab-content">
                    <ul class="accordion__tab-list">
                        <li class="accordion__tab-item" data-ng-repeat="owner in tabs.nodes.metadata.owner | orderBy:['name', '-count']" data-ng-class="{ active: isFilterActive('owner', owner.name, 'nodes') }">
                            <a class="accordion__tab-link" href="" data-ng-click="toggleFilter('owner', owner.name, 'nodes')">{$ owner.name $} ({$ owner.count $})</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="ng-hide accordion__tab" data-ng-show="tabs.nodes.metadata.tags.length">
                <h4 class="accordion__tab-title maas-accordion-tab">Tags</h4>
                <div class="accordion__tab-content">
                    <ul class="accordion__tab-list">
                        <li class="accordion__tab-item" data-ng-repeat="tag in tabs.nodes.metadata.tags | orderBy:['name', '-count']" data-ng-class="{ active: isFilterActive('tags', tag.name, 'nodes') }">
                            <a class="accordion__tab-link" href="" data-ng-click="toggleFilter('tags', tag.name, 'nodes')">{$ tag.name $} ({$ tag.count $})</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="ng-hide accordion__tab" data-ng-show="tabs.nodes.metadata.storage_tags.length">
                <h4 class="accordion__tab-title maas-accordion-tab">Storage Tags</h4>
                <div class="accordion__tab-content">
                    <ul class="accordion__tab-list">
                        <li class="accordion__tab-item" data-ng-repeat="tag in tabs.nodes.metadata.storage_tags | orderBy:['name', '-count']" data-ng-class="{ active: isFilterActive('storage_tags', tag.name, 'nodes') }">
                            <a class="accordion__tab-link" href="" data-ng-click="toggleFilter('storage_tags', tag.name, 'nodes')">{$ tag.name $} ({$ tag.count $})</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="ng-hide accordion__tab" data-ng-show="tabs.nodes.metadata.networks.length">
                <h4 class="accordion__tab-title maas-accordion-tab">Networks</h4>
                <div class="accordion__tab-content">
                    <ul class="accordion__tab-list">
                        <li class="accordion__tab-item" data-ng-repeat="network in tabs.nodes.metadata.networks | orderBy:['name', '-count']" data-ng-class="{ active: isFilterActive('networks', network.name, 'nodes') }">
                            <a class="accordion__tab-link" href="" data-ng-click="toggleFilter('networks', network.name, 'nodes')">{$ network.name $} ({$ network.count $})</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="ng-hide accordion__tab" data-ng-show="tabs.nodes.metadata.zone.length">
                <h4 class="accordion__tab-title maas-accordion-tab">Zones</h4>
                <div class="accordion__tab-content">
                    <ul class="accordion__tab-list">
                        <li class="accordion__tab-item" data-ng-repeat="zone in tabs.nodes.metadata.zone | orderBy:['name', '-count']" data-ng-class="{ active: isFilterActive('zone', zone.name, 'nodes') }">
                            <a class="accordion__tab-link" href="" data-ng-click="toggleFilter('zone', zone.name, 'nodes')">{$ zone.name $} ({$ zone.count $})</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </aside>
    <aside id="sidebar" class="ng-hide" data-ng-show="currentpage === 'devices'"
        data-ng-class="{ disabled: tabs.devices.actionOption }">
        <div class="accordion three-col maas-accordion">
            <h3 class="accordion__title">Filter by</h3>
            <!-- XXX rvba 2015-02-25 - Need to add e2e test. -->
            <div class="ng-hide accordion__tab" data-ng-show="tabs.devices.metadata.owner.length">
                <h4 class="accordion__tab-title maas-accordion-tab active">Owner</h4>
                <div class="accordion__tab-content">
                    <ul class="accordion__tab-list">
                        <li class="accordion__tab-item" data-ng-repeat="owner in tabs.devices.metadata.owner | orderBy:['name', '-count']" data-ng-class="{ active: isFilterActive('owner', owner.name, 'devices') }">
                            <a class="accordion__tab-link" href="" data-ng-click="toggleFilter('owner', owner.name, 'devices')">{$ owner.name $} ({$ owner.count $})</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="ng-hide accordion__tab" data-ng-show="tabs.devices.metadata.tags.length">
                <h4 class="accordion__tab-title maas-accordion-tab">Tags</h4>
                <div class="accordion__tab-content">
                    <ul class="accordion__tab-list">
                        <li class="accordion__tab-item" data-ng-repeat="tag in tabs.devices.metadata.tags | orderBy:['name', '-count']" data-ng-class="{ active: isFilterActive('tags', tag.name, 'devices') }">
                            <a class="accordion__tab-link" href="" data-ng-click="toggleFilter('tags', tag.name, 'devices')">{$ tag.name $} ({$ tag.count $})</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="ng-hide accordion__tab" data-ng-show="tabs.devices.metadata.zone.length">
                <h4 class="accordion__tab-title maas-accordion-tab">Zones</h4>
                <div class="accordion__tab-content">
                    <ul class="accordion__tab-list">
                        <li class="accordion__tab-item" data-ng-repeat="zone in tabs.devices.metadata.zone | orderBy:['name', '-count']" data-ng-class="{ active: isFilterActive('zone', zone.name, 'devices') }">
                            <a class="accordion__tab-link" href="" data-ng-click="toggleFilter('zone', zone.name, 'devices')">{$ zone.name $} ({$ zone.count $})</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </aside>
    <div class="nine-col last-col" data-ng-show="currentpage === 'nodes'">
        <form>
            <div id="search-bar" class="search">
                <!-- XXX blake_r 2015-02-18 - Need to add e2e test. -->
                <input
                    type="search" placeholder="Search nodes" class="search__input"
                    data-ng-model="tabs.nodes.search" data-ng-change="updateFilters('nodes')"
                    data-ng-class="{ error: !tabs.nodes.searchValid }"
                    data-ng-disabled="tabs.nodes.actionOption" />
                <input type="submit" class="search__submit"
                    data-ng-class="{ close: tabs.nodes.search.length > 0 }"
                    data-ng-click="clearSearch('nodes')" />
            </div>
            <table class="table-listing " id="nodes-listing">
                <thead>
                    <tr class="table-listing__row">
                        <th>
                            <!-- XXX blake_r 2015-02-18 - Need to add e2e test. -->
                            <input class="checkbox" type="checkbox" data-ng-click="toggleCheckAll('nodes')" data-ng-model="tabs.nodes.allViewableChecked" id="check-all" data-ng-disabled="hasActionsInProgress('nodes')" />
                            <label class="checkbox-label" for="check-all"></label>
                        </th>
                        <th colspan="2" class="table-listing__header fixed">
                            <!-- XXX blake_r 2015-02-18 - Need to add e2e test. -->
                            <a href="" class="table-listing__header-link"
                                data-ng-click="selectColumnOrSort('fqdn', 'nodes')"
                                data-ng-class="{active: tabs.nodes.column === 'fqdn', sort: tabs.nodes.predicate === 'fqdn', 'sort-asc': tabs.nodes.reverse === false, 'sort-desc': tabs.nodes.reverse === true}"><span title="Fully Qualified Domain Name">FQDN</span></a>
                            <span class="divide"></span>
                            <a href="" class="table-listing__header-link"
                                data-ng-click="selectColumnOrSort('pxe_mac', 'nodes')"
                                data-ng-class="{active: tabs.nodes.column === 'pxe_mac', sort: tabs.nodes.predicate === 'pxe_mac', 'sort-asc': tabs.nodes.reverse === false, 'sort-desc': tabs.nodes.reverse === true}"><span title="Media Access Control addresses">MAC</span></a>
                        </th>
                        <th class="table-listing__header align-center">
                            <!-- XXX blake_r 2015-02-18 - Need to add e2e test. -->
                            <a href="" class="table-listing__header-link align-center" data-ng-click="sortTable('power_state', 'nodes')" data-ng-class="{sort: tabs.nodes.predicate === 'power_state', 'sort-asc': tabs.nodes.reverse === false, 'sort-desc': tabs.nodes.reverse === true}">Power</a>
                        </th>
                        <th class="table-listing__header">
                            <!-- XXX blake_r 2015-02-18 - Need to add e2e test. -->
                            <a href="" class="table-listing__header-link" data-ng-click="sortTable('status', 'nodes')" data-ng-class="{sort: tabs.nodes.predicate === 'status', 'sort-asc': tabs.nodes.reverse === false, 'sort-desc': tabs.nodes.reverse === true}">Status</a>
                        </th>
                        <th class="table-listing__header">
                            <!-- XXX blake_r 2015-02-18 - Need to add e2e test. -->
                            <a href="" class="table-listing__header-link" data-ng-click="sortTable('owner', 'nodes')" data-ng-class="{sort: tabs.nodes.predicate === 'owner', 'sort-asc': tabs.nodes.reverse === false, 'sort-desc': tabs.nodes.reverse === true}">Owner</a>
                        </th>
                        <th class="table-listing__header align-right">
                            <!-- XXX blake_r 2015-02-18 - Need to add e2e test. -->
                            <a href="" class="table-listing__header-link" data-ng-click="sortTable('cpu_count', 'nodes')" data-ng-class="{sort: tabs.nodes.predicate=== 'cpu_count', 'sort-asc': tabs.nodes.reverse === false, 'sort-desc': tabs.nodes.reverse === true}">Cores</a>
                        </th>
                        <th class="table-listing__header align-right">
                            <!-- XXX blake_r 2015-02-18 - Need to add e2e test. -->
                            <a href="" class="table-listing__header-link" data-ng-click="sortTable('memory', 'nodes')" data-ng-class="{sort: tabs.nodes.predicate === 'memory', 'sort-asc': tabs.nodes.reverse === false, 'sort-desc': tabs.nodes.reverse === true}">RAM (GiB)</a>
                        </th>
                        <th class="table-listing__header align-right">
                            <!-- XXX blake_r 2015-02-18 - Need to add e2e test. -->
                            <a href="" class="table-listing__header-link" data-ng-click="sortTable('disks', 'nodes')" data-ng-class="{sort: tabs.nodes.predicate === 'disks', 'sort-asc': tabs.nodes.reverse === false, 'sort-desc': tabs.nodes.reverse === true}">Disks</a>
                        </th>
                        <th class="table-listing__header align-right">
                            <!-- XXX blake_r 2015-02-18 - Need to add e2e test. -->
                            <a href="" class="table-listing__header-link" data-ng-click="sortTable('storage', 'nodes')" data-ng-class="{sort: tabs.nodes.predicate === 'storage', 'sort-asc': tabs.nodes.reverse === false, 'sort-desc': tabs.nodes.reverse === true}">Storage (GB)</a>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <!-- XXX blake_r 2015-02-18 - Need to add e2e test. This really needs lots of tests. -->
                    <tr class="table-listing__row table-listing-row"
                        data-ng-repeat="node in tabs.nodes.filtered_items = (nodes | nodesFilter:tabs.nodes.search | orderBy:tabs.nodes.predicate:tabs.nodes.reverse) track by node.system_id"
                        data-ng-class="{ error: !supportsAction(node, 'nodes'), selected: node.$selected }">
                        <td class="table-listing__cell">
                            <!-- XXX blake_r 2015-02-18 - Need to add e2e test. -->
                            <input class="checkbox" type="checkbox" data-ng-click="toggleChecked(node, 'nodes')" data-ng-model="node.$selected" id="{$ node.fqdn $}" data-ng-disabled="hasActionsInProgress('nodes')" />
                            <label class="checkbox-label" for="{$ node.fqdn $}"></label>
                        </td>
                        <!-- XXX blake_r 2015-02-18 - Need to add e2e test. -->
                        <td class="node-column table-listing__cell fixed" data-ng-show="tabs.nodes.column === 'fqdn'" colspan="2">
                            <a href="#/node/{$ node.system_id $}">{$ node.fqdn $}</a>
                        </td>
                        <!-- XXX blake_r 2015-02-18 - Need to add e2e test. -->
                        <td class="ng-hide table-listing__cell fixed" data-ng-show="tabs.nodes.column === 'pxe_mac'" colspan="2">
                            <a href="#/node/{$ node.system_id $}" title="{$ node.pxe_mac_vendor $}">{$ node.pxe_mac $}</a>
                            <a href="#/node/{$ node.system_id $}" class="extra-macs" data-ng-show="node.extra_macs.length">(+{$ node.extra_macs.length $})</a>
                        </td>
                        <td class="powerstate align-center table-listing__cell">
                            <span title="{$ node.power_state $}" class="powerstates power-{$ node.power_state $}"></span>
                        </td>
                        <td class="table-listing__cell status">{$ node.status $}</td>
                        <td class="table-listing__cell">{$ node.owner $}</td>
                        <td class="align-right table-listing__cell">{$ node.cpu_count $}</td>
                        <td class="align-right table-listing__cell">{$ node.memory $}</td>
                        <td class="align-right table-listing__cell">{$ node.physical_disk_count $}</td>
                        <td class="align-right table-listing__cell">{$ node.storage $}</td>
                    </tr>
                </tbody>
            </table>
        </form>
    </div>
    <div class="nine-col last-col" class="ng-hide" data-ng-show="currentpage === 'devices'">
        <div class="search">
            <!-- XXX rvba 2015-02-25 - Need to add e2e test. -->
            <input
                type="search" placeholder="Search devices" class="search__input"
                data-ng-model="tabs.devices.search" data-ng-change="updateFilters('devices')"
                data-ng-class="{ error: !tabs.devices.searchValid }"
                data-ng-disabled="tabs.devices.actionOption" />
            <input type="submit" class="search__submit"
                data-ng-class="{ close: tabs.devices.search.length > 0 }"
                data-ng-click="clearSearch('devices')" />
        </div>
        <table class="table-listing" id="nodes-listing">
            <thead>
                <tr class="table-listing__row">
                    <th class="table-listing__header t1">
                        <!-- XXX rvba 2015-02-25 - Need to add e2e test. -->
                        <input type="checkbox" class="checkbox" data-ng-click="toggleCheckAll('devices')" data-ng-model="tabs.devices.allViewableChecked" id="check-all-devices" data-ng-disabled="hasActionsInProgress('devices')" />
                        <label for="check-all-devices" class="checkbox-label"></label>
                    </th>
                    <th class="table-listing__header t24">
                        <!-- XXX rvba 2015-02-25 - Need to add e2e test. -->
                        <a href="" class="table-listing__header-link" data-ng-click="sortTable('fqdn', 'devices')" data-ng-class="{sort: tabs.devices.predicate === 'fqdn', 'sort-asc': tabs.devices.reverse === false, 'sort-desc': tabs.devices.reverse === true}">
                            <span title="Fully Qualified Domain Name">FQDN</span>
                        </a>
                    </th>
                    <th class="table-listing__header t25">
                        <a href="" class="table-listing__header-link" data-ng-click="sortTable('primary_mac', 'devices')" data-ng-class="{sort: tabs.devices.predicate === 'primary_mac', 'sort-asc': tabs.devices.reverse === false, 'sort-desc': tabs.devices.reverse === true}">
                            <span title="Media Access Control addresses">MAC</span>
                        </a>
                    </th>
                    <th class="table-listing__header t15">
                        <a href="" class="table-listing__header-link" data-ng-click="sortTable('ip_assignment', 'devices')" data-ng-class="{sort: tabs.devices.predicate === 'ip_assignment', 'sort-asc': tabs.devices.reverse === false, 'sort-desc': tabs.devices.reverse === true}">IP assignment</a>
                    </th>
                    <th class="table-listing__header t20">
                        <a href="" class="table-listing__header-link" data-ng-click="sortTable('ip_address', 'devices')" data-ng-class="{sort: tabs.devices.predicate === 'ip_address', 'sort-asc': tabs.devices.reverse === false, 'sort-desc': tabs.devices.reverse === true}">IP</a>
                    </th>
                    <th class="table-listing__header t15">
                        <!-- XXX rvba 2015-02-25 - Need to add e2e test. -->
                        <a href="" class="table-listing__header-link" data-ng-click="sortTable('owner', 'devices')" data-ng-class="{sort: tabs.devices.predicate === 'owner', 'sort-asc': tabs.devices.reverse === false, 'sort-desc': tabs.devices.reverse === true}">Owner</a>
                    </th>
                </tr>
            </thead>
            <tbody>
                <!-- XXX rvba 2015-02-25 - Need to add e2e test. This really needs lots of tests. -->
                <tr class="table-listing__row"
                    data-ng-repeat="device in tabs.devices.filtered_items = (devices | nodesFilter:tabs.devices.search | orderBy:tabs.devices.predicate:tabs.devices.reverse) track by device.system_id"
                    data-ng-class="{ error: !supportsAction(device, 'devices'), selected: device.$selected }">
                    <td class="t1 table-listing__cell">
                        <input type="checkbox" class="checkbox" data-ng-click="toggleChecked(device, 'devices')" data-ng-model="device.$selected" id="{$ device.fqdn $}" data-ng-disabled="hasActionsInProgress('devices')"/>
                        <label for="{$ device.fqdn $}" class="checkbox-label"></label>
                    </td>
                    <td class="t24 table-listing__cell">{$ device.fqdn $}</td>
                    <td class="t25 table-listing__cell">
                        {$ device.primary_mac $}
                        <span class="extra-macs" data-ng-show="device.extra_macs.length">(+{$ device.extra_macs.length $})</span>
                    </td>
                    <td class="t15 table-listing__cell">{$ getDeviceIPAssignment(device.ip_assignment) $}</td>
                    <td class="t20 table-listing__cell">{$ device.ip_address $}</td>
                    <td class="t15 table-listing__cell">{$ device.owner $}</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
