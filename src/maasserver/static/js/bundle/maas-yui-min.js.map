{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/maasserver/static/js/yui/io.js","webpack:///./src/maasserver/static/js/yui/os_distro_select.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","r","value","n","__esModule","object","property","prototype","hasOwnProperty","p","s","YUI","add","Y","log","namespace","getIO","io","IO","header","Cookie","requires","OSReleaseWidget","_io","maas","superclass","constructor","apply","this","arguments","NAME","extend","Widget","initializer","cfg","initialSkip","bindTo","osNode","event_name","self","one","on","e","osValue","currentTarget","switchTo","newOSValue","options","all","selected","each","option","sel","modifyOption","selectVisableOption","split_value","split","removeClass","set","addClass","first_option","Array","hasClass","use","releaseWidget","os_distro_select","srcNode","render"],"mappings":"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","file":"maas-yui-min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","/* Copyright 2015 Canonical Ltd.  This software is licensed under the\n * GNU Affero General Public License version 3 (see the file LICENSE).\n *\n * IO module.\n *\n */\n\nYUI.add('maas.io', function(Y) {\n\nY.log('loading maas.io');\n\nvar module = Y.namespace('maas.io');\n\n/**\n * Return a Y.IO object to talk to the MAAS website.\n *\n * @method getIO\n */\nmodule.getIO = function() {\n    var io = new Y.IO();\n    // Populate the header used by Django for CSRF protection.\n    Y.io.header('X-CSRFTOKEN', Y.Cookie.get(\"csrftoken\"));\n    return io;\n};\n\n}, '0.1', {'requires': ['cookie', 'io-base']}\n);\n","/* Copyright 2015-2016 Canonical Ltd.  This software is licensed under the\n * GNU Affero General Public License version 3 (see the file LICENSE).\n *\n * OS/Release seletion utilities.\n *\n * @module Y.maas.power_parameter\n */\n\nYUI.add('maas.os_distro_select', function(Y) {\n\nY.log('loading maas.os_distro_select');\nvar module = Y.namespace('maas.os_distro_select');\n\n// Only used to mockup io in tests.\nmodule._io = new Y.maas.io.getIO();\n\nvar OSReleaseWidget;\n\n/**\n * A widget class that modifies the viewable options of the release\n * field, based on the selected operating system field.\n *\n */\nOSReleaseWidget = function() {\n    OSReleaseWidget.superclass.constructor.apply(this, arguments);\n};\n\nOSReleaseWidget.NAME = 'os-release-widget';\n\nY.extend(OSReleaseWidget, Y.Widget, {\n\n   /**\n    * Initialize the widget.\n    * - cfg.srcNode is the node which will be updated when the selected\n    *   value of the 'os node' will change.\n    * - cfg.osNode is the node containing a 'select' element.  When\n    *   the selected element will change, the srcNode HTML will be\n    *   updated.\n    *\n    * @method initializer\n    */\n    initializer: function(cfg) {\n        this.initialSkip = true;\n    },\n\n   /**\n    * Bind the widget to events (to name 'event_name') generated by the given\n    * 'osNode'.\n    *\n    * @method bindTo\n    */\n    bindTo: function(osNode, event_name) {\n        var self = this;\n        if (!osNode) {\n            return;\n        }\n        Y.one(osNode).on(event_name, function(e) {\n            var osValue = e.currentTarget.get('value');\n            self.switchTo(osValue);\n        });\n        var osValue = Y.one(osNode).get('value');\n        self.switchTo(osValue);\n    },\n\n   /**\n    * React to a new value of the os node: update the HTML of\n    * 'srcNode'.\n    *\n    * @method switchTo\n    */\n    switchTo: function(newOSValue) {\n        var srcNode = this.get('srcNode');\n        var options = srcNode.all('option');\n        var selected = false;\n        options.each(function(option) {\n            var sel = this.modifyOption(option, newOSValue);\n            if (selected === false) {\n                selected = sel;\n            }\n        }, this);\n\n        // We skip selection on first load, as Django will already\n        // provide the users, current selection. Without this the\n        // current selection will be clobered.\n        if (this.initialSkip === true) {\n            this.initialSkip = false;\n            return;\n        }\n\n        // See if a selection was made, if not then we need\n        // to select the first visible as a default is not\n        // present.\n        if(!selected) {\n            this.selectVisableOption(options);\n        }\n    },\n\n   /**\n    * Modify an option to make it visible or hidden. Returns true\n    * if the method also make the selection active.\n    *\n    * @method modifyOption\n    */\n    modifyOption: function(option, newOSValue) {\n        var selected = false;\n        var value = option.get('value');\n        var split_value = value.split(\"/\");\n\n        // If \"Default OS\" is selected, then\n        // only show \"Default OS Release\".\n        if(newOSValue === '') {\n            if(value === '') {\n                option.removeClass('hidden');\n                option.set('selected', 'selected');\n            }\n            else {\n                option.addClass('hidden');\n            }\n        }\n        else {\n            if(split_value[0] === newOSValue) {\n                option.removeClass('hidden');\n                if(split_value[1] === '' && !this.initialSkip) {\n                    selected = true;\n                    option.set('selected', 'selected');\n                }\n            }\n            else {\n                option.addClass('hidden');\n            }\n        }\n        return selected;\n    },\n\n   /**\n    * Selected the first option that is not hidden.\n    *\n    * @method selectVisableOption\n    */\n    selectVisableOption: function(options) {\n        var first_option = null;\n        Y.Array.each(options, function(option) {\n            if(!option.hasClass('hidden')) {\n                if(first_option === null) {\n                    first_option = option;\n                }\n            }\n        });\n        if(first_option !== null) {\n            first_option.set('selected', 'selected');\n        }\n    }\n});\n\nmodule.OSReleaseWidget = OSReleaseWidget;\n\n}, '0.1', {'requires': ['widget', 'maas.io']}\n);\n\nYUI().use(\n  'maas.os_distro_select',\n  function (Y) {\n  Y.on('load', function() {\n    // Create OSDistroWidget so that the release field will be\n    // updated each time the value of the os field changes.\n    var releaseWidget = new Y.maas.os_distro_select.OSReleaseWidget({\n        srcNode: '#id_deploy-default_distro_series'\n        });\n    releaseWidget.bindTo(Y.one('#id_deploy-default_osystem'), 'change');\n    releaseWidget.render();\n  });\n});\n"],"sourceRoot":""}