{% extends "maasserver/base.html" %}

{% block nav-active-index %}active{% endblock %}
{% block title %}Dashboard{% endblock %}
{% block site-switcher %}{% endblock %}

{% block html_includes %}{% include "maasserver/snippets.html" %}{% endblock %}

{% block head %}
    <script type="text/javascript" src="{% url "combo-raphael" %}?raphael-min.js"></script>
    <script type="text/javascript">
    <!--
        YUI().use('maas.enums', 'maas.node_add', 'maas.node','maas.node_views','maas.utils', 'maas.shortpoll', function (Y) {Y.on('load', function() {
            // Create Dashboard view.
            var power_types = {{ power_types }};
            var view = new Y.maas.node_views.NodesDashboard({
                srcNode: '#dashboard',
                summaryNode: '#summary',
                numberNode: '#nodes-number',
                descriptionNode: '#nodes-description',
                reservedNode: '#reserved-nodes',
                retiredNode: '#retired-nodes'});

            var poller = new Y.maas.shortpoll.ShortPollManager({
                uri: MAAS_config.uris.nodes_handler + "?op=list"
            });

            view.addLoader(poller.get("io"));
            poller.poll();

            Y.one('#addnode').on('click', function(e) {
                e.preventDefault();
                Y.maas.node_add.showAddNodeWidget({
                    powerTypes: power_types,
                    targetNode: '#dashboard'
                });
            });

            // Setup TitleEditWidget.
            var title_widget = new Y.maas.utils.TitleEditWidget(
                {srcNode: '.page-title-form'});
                title_widget.render();
            });
        });
        // -->
    </script>
{% endblock %}

{% block page-title-block %}
{% if user.is_superuser %}
<form action="" method="" class="page-title-form">
    <input type="text" value="{{ global_options.site_name }} MAAS" title="Edit the name of this MAAS" />
</form>
{% else %}
<h1 id="page-title">{% include "maasserver/site_title.html" %}</h1>
{% endif %}
{% endblock %}

{% block content %}
<div id="dashboard" class="twelve-col">
   <section id="chart" class="four-col"></section>
   <section id="summary" class="eight-col last-col">
        <h2 id="nodes-number"></h2>
        <p id="nodes-description"></p>
    </section>
    <p id="reserved-nodes"></p>
    <p id="retired-nodes"></p>
    <a href="#" id="addnode" class="link-cta-ubuntu">+ Add node</a>
</div>
{% endblock %}
