.\" Man page generated from reStructuredText.
.
.TH "MAAS-IMPORT-PXE-FILES" "8" "May 27, 2014" "1.6" "MAAS"
.SH NAME
maas-import-pxe-files \- MAAS helper script
.
.nr rst2man-indent-level 0
.
.de1 rstReportMargin
\\$1 \\n[an-margin]
level \\n[rst2man-indent-level]
level margin: \\n[rst2man-indent\\n[rst2man-indent-level]]
-
\\n[rst2man-indent0]
\\n[rst2man-indent1]
\\n[rst2man-indent2]
..
.de1 INDENT
.\" .rstReportMargin pre:
. RS \\$1
. nr rst2man-indent\\n[rst2man-indent-level] \\n[an-margin]
. nr rst2man-indent-level +1
.\" .rstReportMargin post:
..
.de UNINDENT
. RE
.\" indent \\n[an-margin]
.\" old: \\n[rst2man-indent\\n[rst2man-indent-level]]
.nr rst2man-indent-level -1
.\" new: \\n[rst2man-indent\\n[rst2man-indent-level]]
.in \\n[rst2man-indent\\n[rst2man-indent-level]]u
..
.SH USAGE
.sp
maas\-import\-pxe\-files [\-h, \-\-help]
.sp
maas\-import\-pxe\-files \-\-sources\-file <sources>
.SH DESCRIPTION
.sp
This is a helper script for MAAS (Metal As A Service). It downloads operating
system images, prepares them for use by MAAS nodes, and makes them available
for nodes to boot over the network through TFTP, iSCSI, and SMB as
appropriate.
.sp
The imports are normally performed automatically once a week, and can also
be triggered from the user interface or API (see below).  The script is an
alternative way of doing this, but the UI/API/scheduled way is preferred.
There are several differences between the script and these other ways of
running the imports.  See \fI\%Script vs UI/API\fP below.
.sp
Images that are already in place are kept unchanged, unless the
version in the upstream archive has since been updated.  Only new data is
downloaded, so running this script frequently should not be more costly
than running it only rarely.
.SH SCRIPT VS UI/API
.sp
We recommend triggering manual imports through the UI or API over the
\fBmaas\-import\-pxe\-files\fP script.  However there may be circumstances where
you might prefer the command\-line script, in which case there are several
differences you need to be aware of:
.INDENT 0.0
.IP \(bu 2
The command\-line script must run on a cluster controller.  All other ways
of running the imports are triggered on the region controller, and this can
be done remotely.
.IP \(bu 2
Running the command\-line script on a cluster controller imports images only
on that cluster controller.
.IP \(bu 2
The command\-line script must run as \fBroot\fP\&.  When MAAS itself performs
imports, it runs them under the \fBmaas\fP user.  Files will be written with
\fBroot\fP ownership, which may introduce permissions problems for the regular
MAAS\-triggered imports.
.IP \(bu 2
If you run the command\-line script using \fBsudo\fP, be aware that it will
modify state under \fB$HOME/.gnupg\fP\&.  Since \fBsudo\fP does not change
\fB$HOME\fP by default, this may result in \fBroot\fP becoming the owner of some
GPG files in your home directory.
.IP \(bu 2
The command\-line script completes once the imports are done, but at that
point the region controller may not have been notified of newly available
boot images yet.  There may be a wait of up to 5 minutes.  When MAAS itself
triggers the imports, this notification is triggered immediately when the
imports finish.
.UNINDENT
.SH IMPORTING FROM THE UI
.sp
To trigger imports from the browser user interface, log in to your MAAS as an
administrator using a web browser, click the "Clusters" tab at the top of the
page to go to the Clusters page, and click "Import boot images."  This will
start imports on all cluster controllers simultaneously.
.sp
The same thing can also be done through the region\-controller API, or through
the command\-line interface.  The API and command\-line interface also support
importing images for one particular cluster.
.SH CONFIGURATION
.sp
Downloaded images are stored in \fB/var/lib/maas/boot\-resources\fP\&.  In order to
know what to download, you must pass the script a list of image "sources," in
the form of a YAML\-encoded list.  Pass the name of that YAML file to the
\fB\-\-sources\-file\fP option.
.sp
Each "source" defines a Simplestreams repository location (\fBurl\fP) from
which images can be downloaded; a \fBkeyring\fP for validating index and image
signatures from that location; and a series of filters (\fBselections\fP)
specifying which images should be downloaded from that source.
.sp
Each "selection" can contain any of the following constraints:
.INDENT 0.0
.IP \(bu 2
\fBrelease\fP: Operating system release, e.g. \fBtrusty\fP for Ubuntu 14.04.
.IP \(bu 2
\fBarches\fP: List of CPU architectures, e.g. \fBamd64\fP, \fBarmhf\fP, \fBi386\fP,
etc.
.IP \(bu 2
\fBsubarches\fP: List of "sub\-architectures" for more specific system
architecture requirements.  Typically \fBgeneric\fP, but may be e.g. \fBhwe\-p\fP
for hardware which on Ubuntu 12.04 Precise Pangolin still requires special
hardware\-enablement kernels.
.IP \(bu 2
\fBlabels\fP: List of release labels, such as \fBrelease\fP or \fBbeta1\fP\&.  For
normal use, specify \fBrelease\fP\&.
.UNINDENT
.sp
For any of these filter items, an asterisk (\fB*\fP) denotes "match any value."
To match all available architectures, for example, specify an architecture
value of \fB"*"\fP in the \fBarches\fP list.
.sp
Here\(aqs an example of an import source description:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
\- url "http://maas.ubuntu.com/images/ephemeral\-v2/releases/"
  keyring: "/usr/share/keyrings/ubuntu\-cloudimage\-keyring.gpg"
  selections:
    \- release: "precise"
      arches: ["i386", "amd64"]
      subarches: ["generic"]
      labels: ["release"]
    \- release: "trusty"
      arches: ["*"]
      subarches: ["generic"]
      labels: ["release"]
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
This uses one source, but imports multiple kinds of images from that source:
Ubuntu 12.04 ("precise") release images for the i386 and amd64 architectures,
plus Ubuntu 14.04 ("trusty") images for all supported architectures.
.SH FURTHER DOCUMENTATION
.sp
Full MAAS documentation is at \fI\%https://maas.ubuntu.com/docs\fP
.sp
Imports through the browser interface are described at
\fI\%http://maas.ubuntu.com/docs/install.html#import\-the\-boot\-images\fP
.SH SEE ALSO
.sp
\fImaas\-region\-admin\fP, \fImaas\fP
.SH AUTHOR
Canonical 2013
.SH COPYRIGHT
2012-2014, MAAS Developers
.\" Generated by docutils manpage writer.
.
